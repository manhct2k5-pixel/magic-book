<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hợp đồng tình yêu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;600&family=Cormorant+Garamond:wght@400;600;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    
    <script type="importmap">
        {
            "imports": {
                "@mediapipe/tasks-vision": "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3"
            }
        }
    </script>
</head>
<body>
    <div id="loading-screen">
        <div class="loading-title">Hợp Đồng Tình Yêu</div>
        <div class="loader"></div>
        <div class="loading-text" aria-live="polite">Đang gom kỷ niệm...</div>
        <div class="loading-progress" aria-hidden="true">
            <div class="loading-progress-bar" id="loading-bar"></div>
        </div>
        <div class="loading-percent" id="loading-percent">0%</div>
    </div>

    <div id="intro-screen">
        <div id="intro-card">
            <div class="intro-eyebrow">Hợp đồng tình yêu</div>
            <h1>Hãy lựa chọn đáp án phù hợp nhất</h1>
            <p>Bạn có đồng ý kí thêm bản hợp đồng tình yêu lâu dài với người yêu hiện tại của bạn không?</p>
            <div class="intro-actions">
                <button class="intro-btn" id="intro-yes" type="button" aria-label="Đồng ý">Đồng ý</button>
                <button class="intro-btn" id="intro-no" type="button" aria-label="Không đồng ý">Không đồng ý</button>
            </div>
        </div>
    </div>

    <div id="retry-modal" aria-hidden="true">
        <div class="retry-card" role="alert">
            <img class="retry-face" src="Ảnh/1.jpg" alt="Mặt hài hước">
            <div class="retry-text">Chọn lại đi mà!</div>
        </div>
    </div>

    <div id="letter-modal" aria-hidden="true">
        <div id="letter-card">
            <button id="letter-close" type="button" aria-label="Đóng">×</button>
            <div class="letter-header">
                <div class="letter-eyebrow">Lá thư kỷ niệm</div>
                <div class="letter-title">Tròn 1 năm bên nhau</div>
                <div class="letter-divider"></div>
            </div>
            <div class="letter-body">
                <p><strong>Vợ ơi,</strong></p>
                <p>Vậy là vợ chồng mình <strong>tròn 1 năm</strong> rồi đó. Chồng ngồi viết mà vừa nghiêm túc vừa buồn cười… vì mới ngày nào chồng còn <strong>run run e thẹn nắm tay vợ đi dạo quanh Bảo tàng Quân sự Việt Nam</strong>, cứ như nắm tay “nữ thần” chứ không phải nắm tay người yêu. Vậy mà giờ chồng đã quen với đặc quyền cao cấp nhất đời mình: <strong>được vợ ôm</strong>… và được vợ <strong>nhắc nhở/cằn nhằn</strong> đủ thứ từ ăn uống, ngủ nghỉ, ăn mặc. Đúng kiểu “hậu phương vững chắc” của chồng luôn.</p>
                <p>Một năm qua, vợ chồng mình đi qua nhiều nơi — và cũng đi qua đủ mọi “địa hình” trong tình yêu: mình <strong>cãi nhau nhiều lần</strong>, có lúc <strong>dừng lại</strong>, rồi lại <strong>tiếp tục yêu</strong>, có lúc căng đến mức còn <strong>báo cả phụ huynh</strong>. Nghe thì mệt, nhưng nhìn lại chồng lại thấy… tụi mình yêu thật nên mới vậy. Yêu thật nên mới đau thật, mới nghĩ nhiều, mới cố mà đi tiếp.</p>
                <p>Chồng biết vợ chồng mình đã làm nhau buồn không ít. Nhưng mình cũng làm nhau vui rất nhiều. Và điều khiến chồng nhớ nhất là vợ đã chăm chồng <strong>từng li từng tí</strong>: lo lắng, nhường nhịn, để ý những chuyện nhỏ xíu mà chồng hay bỏ qua. Có những lúc chồng thấy vợ giống như <strong>người mẹ thứ hai</strong> của chồng vậy… chỉ khác cái là mẹ nói một lần, còn vợ nói một lần rồi… <strong>nhắc thêm vài lần cho chắc</strong>.</p>
                <p>Vợ à, chồng cũng phải nói thật: vợ <strong>cứng đầu</strong> kinh khủng. Nhiều lúc chồng bất lực luôn, kiểu “chồng thua, chồng xin rút lui.” Nhưng chồng hiểu, chính cái cứng đầu đó là phần làm vợ mạnh mẽ, là cái khiến vợ không dễ buông bỏ. Và cũng vì vậy mà vợ mới thương chồng theo kiểu rất “vợ”: có thể giận, có thể khóc, nhưng vẫn không nỡ bỏ chồng một mình.</p>
                <p>Mà vợ còn <strong>mít ướt</strong> nữa. Dễ khóc, hay <strong>ovtk</strong>. Có lúc vợ khóc vì vợ buồn. Có lúc vợ lại khóc chỉ vì thấy <strong>chồng buồn</strong>, chồng mệt. Chồng nhớ những lần vợ không ngại mệt mà lên chơi với chồng, dù biết vợ cũng áp lực đủ thứ:</p>
                <ul>
                    <li><strong>Bố mẹ vợ còn chưa mở lòng với chồng</strong>.</li>
                    <li><strong>Khoảng cách 310km từ Nghệ An đến Hà Nội</strong>.</li>
                    <li>Lên Hà Nội rồi, trọ chồng vẫn <strong>xa nhà vợ 12 cây</strong>.</li>
                </ul>
                <p>Vậy mà chồng vẫn thích lên gặp vợ. Vì chồng <strong>yêu</strong>, chồng <strong>nhớ</strong>, chồng <strong>muốn gặp</strong>. Và chồng thích nhất là được chở vợ về — để vợ ôm chồng từ phía sau. Cái ôm đó với chồng giống như được “sạc pin”: ấm, yên, và làm chồng thấy mình có nhà.</p>
                <p>Hôm nay, chồng muốn nói rõ ràng, nghiêm túc, không vòng vo:</p>
                <p><strong>Chồng yêu vợ. Chồng chọn vợ. Và chồng chỉ yêu một mình vợ thôi.</strong> Vợ đừng ovtk nữa, đừng nghĩ chồng sẽ đi với cô gái khác nữa. Chồng không cần ai khác để khiến tim chồng rung. Chồng chỉ cần vợ — người vừa làm chồng muốn sống tốt hơn, vừa làm chồng muốn cố gắng hơn mỗi ngày.</p>
                <p>Chồng mong vợ <strong>cười nhiều hơn</strong>. Mong vợ bớt khóc, bớt tự làm mình đau bằng những suy nghĩ không đáng. Mong vợ tin chồng — tin vào những gì chồng đang làm và tin vào điều quan trọng nhất: <strong>chồng vẫn ở đây, vẫn hướng về vợ, vẫn chọn vợ</strong>.</p>
                <p>Chồng không hứa tình yêu lúc nào cũng ngọt như phim, nhưng chồng hứa sẽ luôn <strong>ở lại</strong>, luôn <strong>nắm tay vợ</strong>, luôn <strong>cùng vợ giải quyết</strong>. Để sau này, bố mẹ vợ nhìn vào sẽ thấy: “Ừ, thằng này có thể chưa hoàn hảo, nhưng nó thương con mình thật.”</p>
                <p>Chúc mừng kỷ niệm 1 năm của vợ chồng mình. Cảm ơn vợ vì đã thương chồng, lo cho chồng, nhắc chồng, và vẫn chọn chồng dù chồng nhiều lúc vụng về.</p>
                <p>Thương vợ nhiều lắm.<br>Chồng của vợ</p>
                <p class="letter-sign">___MPV___</p>
            </div>
        </div>
    </div>

    <div id="lock-overlay">
        <canvas id="lock-canvas"></canvas>
        <div id="guide-text">Vẽ hình trái tim để mở khóa</div>
        <button id="skip-lock" type="button">Bỏ qua mở khóa</button>
    </div>

    <div id="chapter-loader" aria-hidden="true">
        <div class="chapter-loader-card">
            <div class="chapter-loader-title">Đang tải chương...</div>
            <div class="chapter-loader-track">
                <div class="chapter-loader-bar" id="chapter-loader-bar"></div>
            </div>
            <div class="chapter-loader-text" id="chapter-loader-text">0%</div>
        </div>
    </div>

    <div id="fallback" aria-hidden="true">
        <div class="fallback-card">
            <div class="fallback-title">Không thể dùng camera</div>
            <p>Trình duyệt không hỗ trợ hoặc không cấp quyền camera. Bạn vẫn có thể xem bằng cách tiếp tục không dùng camera.</p>
            <button id="fallback-start" type="button">Tiếp tục không cần camera</button>
        </div>
    </div>

    <div id="heart-field" aria-hidden="true"></div>
    <div id="frame" aria-hidden="true"></div>

    <div id="memory-stage" aria-hidden="true">
        <div id="heart-box">
            <div class="heart-lid heart-piece"></div>
            <div class="heart-base heart-piece"></div>
            <div class="heart-ribbon"></div>
            <div class="heart-bow"><span></span></div>
        </div>
        <div id="chapter-photos" aria-hidden="true">
            <div id="chapter-photo-frame">
                <img id="chapter-photo" alt="" loading="lazy" decoding="async">
            </div>
            <div id="chapter-fan" aria-hidden="true"></div>
            <div id="chapter-collage" aria-hidden="true"></div>
        </div>
        <div id="subtitle-container">
            <div id="subtitle">
                <div id="chapter-kicker"></div>
                <div id="chapter-title"></div>
                <div id="chapter-line"></div>
            </div>
        </div>
    </div>

    <div id="vignette"></div>
    <div id="noise"></div>
    
    <video id="webcam" autoplay playsinline style="display:none;"></video>
    <canvas id="cam-feedback"></canvas> 
    <div id="ai-status" role="status" aria-live="polite">Sẵn sàng</div>

    <div id="ui">
        <div class="ui-subtitle large">Kỷ niệm 365 ngày bên nhau</div>
    </div>

    <div id="controls" aria-label="Điều khiển">
        <button id="btn-chapters" type="button" aria-haspopup="dialog" data-icon="≡">Chương</button>
        <button id="btn-bookmark" type="button" data-icon="★">Đánh dấu</button>
        <button id="btn-fullscreen" type="button" data-icon="⤢">Toàn màn hình</button>
    </div>

    <div id="chapter-panel" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="chapter-panel-card">
            <div class="chapter-panel-header">
                <div class="chapter-panel-title">Chọn chương</div>
                <button id="chapter-close" type="button" aria-label="Đóng">×</button>
            </div>
            <div id="chapter-list" class="chapter-panel-list" role="listbox"></div>
        </div>
    </div>

    <div id="credit">__MPV with LOVE __</div>

    <script type="module" src="app.js"></script>

</body>
</html>
